# ADR 001: 本アプリケーションで扱える音声ファイルについて

Date: 2025/05/11

## Context
<!-- この決定が必要になった背景 -->
- 音声ファイルをopensslなどで暗号化し、そのファイルを復号すると音声ファイルが破損するケースがある。
- m4a形式(mpeg4コンテナ,AACコーデック)のファイルを復号した際、moov atomの情報が破損した
- 再生するにはmdat atomのみを暗号化する、widevineによるDRMを用いるなどの工夫が必要だと考えられる

## Decision
<!-- 下した決断 -->
- 最初の検証ではm4aファイルを扱わない。

## Consequences

- Pros:
  <!-- - 例: テストが書きやすくなる -->
  - ファイル全体を復号すれば良くなるので暗号化と復号の両方のロジックが単純になる
- Cons:
  <!-- - 例: コード量が増える -->
  - 低ビットレート時(128kbps以下)の音質時はAACの方が音質的に有利になるため、低ビットレート時のベストな選択を取れなくなる

## Alternatives
<!-- 別案あれば -->

- m4aのmdat atomのみを暗号化する
- widevineによるDRMを用いる
